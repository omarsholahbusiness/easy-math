# حل مشكلة: نطاق غير صالح لمفتاح الموقع reCAPTCHA

## المشكلة
بعد تغيير نطاق الموقع، تظهر رسالة خطأ:
```
خطأ لمالك الموقع: نطاق غير صالح لمفتاح الموقع
```

## الحل

### الطريقة 1: إضافة النطاق الجديد إلى reCAPTCHA الحالي (موصى به)

1. **اذهب إلى Google reCAPTCHA Admin Console**
   - الرابط: https://www.google.com/recaptcha/admin
   - سجل الدخول بحساب Google الخاص بك

2. **ابحث عن موقع reCAPTCHA الخاص بك**
   - ستجد قائمة بجميع المواقع المسجلة
   - اضغط على الموقع الذي تستخدمه (أو الذي يحتوي على `NEXT_PUBLIC_RECAPTCHA_SITE_KEY`)

3. **أضف النطاق الجديد**
   - اضغط على **Settings** (الإعدادات) أو **Edit** (تعديل)
   - في قسم **Domains** (النطاقات)، اضغط على **+ Add Domain**
   - أضف النطاق الجديد، على سبيل المثال:
     - `yournewdomain.com`
     - `www.yournewdomain.com`
     - `localhost` (إذا كنت تختبر محلياً)
   - **ملاحظة مهمة**: لا تضيف `http://` أو `https://` - فقط اسم النطاق

4. **احفظ التغييرات**
   - اضغط **Save** أو **Submit**
   - قد يستغرق الأمر بضع دقائق حتى تصبح التغييرات فعالة

### الطريقة 2: إنشاء موقع reCAPTCHA جديد (إذا لم تستطع تعديل القديم)

1. **إنشاء موقع جديد**
   - اذهب إلى https://www.google.com/recaptcha/admin
   - اضغط على **"+"** لإنشاء موقع جديد
   - اختر **reCAPTCHA v2** (إذا كنت تستخدم v2) أو **reCAPTCHA v3**

2. **أدخل المعلومات**
   - **Label**: اسم للموقع (مثل: Easy Math - New Domain)
   - **Domains**: أضف النطاقات:
     - النطاق الجديد: `yournewdomain.com`
     - `www.yournewdomain.com`
     - `localhost` (للتطوير)

3. **احصل على المفاتيح الجديدة**
   - بعد الإنشاء، ستحصل على:
     - **Site Key** (المفتاح العام)
     - **Secret Key** (المفتاح السري)

4. **حدّث ملف `.env`**
   ```env
   NEXT_PUBLIC_RECAPTCHA_SITE_KEY="your_new_site_key_here"
   RECAPTCHA_SECRET_KEY="your_new_secret_key_here"
   ```

5. **أعد تشغيل الخادم**
   ```bash
   # أوقف الخادم (Ctrl+C)
   npm run dev
   ```

## النطاقات المدعومة

عند إضافة النطاقات، يمكنك إضافة:

✅ **صحيح:**
- `example.com`
- `www.example.com`
- `localhost`
- `127.0.0.1`
- `subdomain.example.com`

❌ **خطأ:**
- `https://example.com` (لا تضيف البروتوكول)
- `http://example.com` (لا تضيف البروتوكول)
- `example.com/path` (لا تضيف المسار)

## التحقق من الإعداد

بعد إضافة النطاق:

1. **انتظر 2-5 دقائق** حتى تصبح التغييرات فعالة
2. **أعد تحميل الصفحة** (Ctrl+F5 أو Cmd+Shift+R)
3. **اختبر reCAPTCHA** في صفحة إنشاء الحساب
4. **تحقق من Console** في المتصفح (F12) للتأكد من عدم وجود أخطاء

## استكشاف الأخطاء

### المشكلة: لا يزال الخطأ يظهر
- ✅ تأكد من إضافة النطاق الصحيح (بدون `http://` أو `https://`)
- ✅ انتظر بضع دقائق - التغييرات قد تستغرق وقتاً
- ✅ امسح الكاش في المتصفح (Ctrl+Shift+Delete)
- ✅ أعد تحميل الصفحة بقوة (Ctrl+F5)

### المشكلة: لا أستطيع تعديل الموقع القديم
- استخدم الطريقة 2 (إنشاء موقع جديد)
- أو تواصل مع دعم Google reCAPTCHA

### المشكلة: النطاق لا يعمل في localhost
- تأكد من إضافة `localhost` و `127.0.0.1` في قائمة النطاقات
- في وضع التطوير، يمكنك تعطيل reCAPTCHA مؤقتاً

## ملاحظات مهمة

1. **لا حاجة لتغيير الكود** - فقط أضف النطاق في Google Console
2. **يمكنك إضافة عدة نطاقات** لنفس المفتاح
3. **التغييرات فورية تقريباً** لكن قد تستغرق بضع دقائق
4. **احتفظ بنسخة احتياطية** من المفاتيح القديمة

## رابط مفيد

- Google reCAPTCHA Admin: https://www.google.com/recaptcha/admin
- وثائق reCAPTCHA: https://developers.google.com/recaptcha/docs/domain_validation

